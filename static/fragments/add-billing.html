<!-- Billing Modal Fragment -->
<div id="billing-modal" class="modal-overlay" style="display:none;">
  <div class="modal-content billing-modal-content">
    <h2>Billing Codes</h2>
    <table class="billing-modal-table">
      <thead>
        <tr>
          <th>Code</th>
          <th>Description</th>
          <th>Number</th>
          <th>Modifier</th>
          <th>Rate</th>
          <th>Total</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody id="billing-modal-table-body">
        <tr class="billing-modal-entry">
            <td>
              <input
                name="code_id[]"
                list="billing-codes-datalist"
                placeholder="Start typing code"
                oninput="populateBillingRow(this)"
                style="width: 100%;"
              >
            </td>
            <td class="description-cell">—</td>
            <td>
              <input
                type="number"
                name="number[]"
                value="1"
                min="1"
                onchange="recalculateTotal(this)"
                style="width: 60px;"
              >
            </td>
            <td>
              <select
                name="billing_modifier[]"
                onchange="applyModifier(this)"
                style="width: 100%;"
              >
                <option value="">None</option>
              </select>
            </td>
            <td class="rate-cell">—</td>
            <td class="total-cell">—</td>
            <td>
              <button
                type="button"
                class="remove-row-btn"
                onclick="removeBillingRow(this)"
                style="padding: 0.2rem 0.5rem;"
              >✕</button>
            </td>
          </tr>
      </tbody>
      <tfoot>
        <tr>
          <td colspan="5" style="text-align:right;font-weight:bold;">Total:</td>
          <td colspan="2" style="font-weight:bold;">
            R<span id="overall-total">0.00</span>
          </td>
        </tr>
      </tfoot>
    </table>
    <datalist id="billing-codes-datalist"></datalist>
    <div class="billing-modal-actions">
      <button type="button" class="add-row-btn" onclick="addBillingRow()">+ Add Row</button>
      <button type="button" class="close-modal-btn" onclick="document.getElementById('billing-modal').style.display='none'">Close</button>
    </div>
    <div style="margin-top: 1.2em; text-align: right;">
      <button type="button" onclick="submitBillingModal()">Save Billing</button>
    </div>
  </div>
</div>
